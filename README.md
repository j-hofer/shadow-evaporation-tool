# About

This KLayout macro facilitates the mask design and process creation for the shadow (angular) evaporation technique. The process parameters (mask height, deposition angles) can be specified and the resulting structures are automatically generated as new GDS layers.

At the moment, the macro is in an early stage and the functionality is limited. For any feature suggestions, questions and bug reports, feel free to contact the author.

# Installation

Install the macro using built-in KLayout package manager: In the KLayout main window, select "Tools">"Manage Packages" from the menu bar, then select the package from the list of available packages and install by clicking "Apply".

# Usage

After installation, a new button (*'Shadow evaporation process'*) should appear in the toolbar which opens a separate window.

In this window, specify the mask (the regions exposed during lithography) by entering the layer and datatype index of the corresponding GDS layer. Then add one or more deposition steps by clicking on "+". Specify the deposition angle in degrees, as well as the layer/datatype, where the resulting structures should be placed. Clicking on 'Apply' draws the structures according to the specified parameters.

**The GDS layers specified in the process table are cleared int order to fill them the resulting structures. The previous state can be restored using Ctrl+Z. Activating the 'Auto apply' option may clutter the undo stack though.**
A pop-up will warn you about this before applying the process to the GDS file. You can suppress this message until KLayout is restarted by clicking on "Apply and do not show this again" in the pop-up.

![Basic tutorial](https://i.imgur.com/z0uBLqg.gif)

*Hint: Although you can change the order of the specified deposition steps, this does not affect the objects generated by the macro. Still, you might find it useful for keeping track of the deposition order later.*

### Angle conventions

The tilt angle is specified in degrees. Positive angles correspond to upwards displacement and vice versa. The definition of the angles relies on the correct alignment of the sample inside the evaporation machine. Also, the evaporator may use different angle conventions or zero references. In this case the angles specified in the macro need to be translated to the convention of the used evaporator.

### Auto apply

When the "Auto apply" option is checked, the resulting structures are instantly redrawn when a parameter is modified, allowing for rapid process creation.

![Auto apply tutorial](https://i.imgur.com/P36WB6l.gif)

## Save and load a recipe

All specified parameters stay in place until the main KLayout window is closed, even when the macro window is closed and reopened.
Processes can be saved as an easily readable and modifiable `.json` file. The file ending is `.prc.json` in order to distinguish it from other `.json` files.

## Limitations

* Due to the finite thickness of the suspended mask, structures at deposited at higher polar angles get compressed. At the moment, this is not taken into account by the macro.

* Rotation along an axis perpendicular to the substrate (azimuthal/planetary rotation) are not taken into account.

Compression and azimuthal rotation may be included upon expressed demand.

* Structures can only be placed on the substrate in regions where the lower resist layer has been removed (suspended regions/"undercut"). Shadows can either be deposited on the walls of the lower resist layer and fall onto the main structure upon resist lift off, or they can be supressed completely, depending on the deposition angle and the defined undercut. This behaviour should be taken into account by the user and there are no intentios to add estimations about this to the macro.


# Author & License

Copyright (c) 2023 Johannes HÃ¶fer (johannes.hofer@neel.cnrs.fr)

MIT License